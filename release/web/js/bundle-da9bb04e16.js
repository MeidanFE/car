!function(){"use strict";class t extends Laya.Script{constructor(){super(),this.moveSpeed=20}onAwake(){Laya.timer.frameLoop(1,this,this.frameLoop)}frameLoop(){const t=this.owner;t.y+=this.moveSpeed,t.y>1920&&(t.y=-1920)}}class e extends Laya.Script{constructor(){super(),this.btn_Play=null,this.btn_AudioOn=null,this.btn_AudioOff=null}onAwake(){this.btn_Play.on(Laya.Event.CLICK,this,this.btnPlayClick),this.btn_AudioOn.on(Laya.Event.CLICK,this,this.btnAudioOnClick),this.btn_AudioOff.on(Laya.Event.CLICK,this,this.btnAudioOffClick),Laya.stage.on("Mute",this,this.IsMute)}btnPlayClick(){this.owner.visible=!1,Laya.stage.event("StartGame"),Laya.SoundManager.playSound("Sounds/ButtonClick.ogg",1)}btnAudioOnClick(){this.btn_AudioOff.visible=!0,this.btn_AudioOn.visible=!1,Laya.SoundManager.playSound("Sounds/ButtonClick.ogg",1),Laya.SoundManager.muted=!0,Laya.stage.event("Mute",!0)}btnAudioOffClick(){this.btn_AudioOff.visible=!1,this.btn_AudioOn.visible=!0,Laya.SoundManager.playSound("Sounds/ButtonClick.ogg",1),Laya.SoundManager.muted=!1,Laya.stage.event("Mute",!1)}HomeButtonClick(){this.owner.visible=!0}IsMute(t){t?(this.owner.getChildByName("btn_AudioOn").visible=!1,this.owner.getChildByName("btn_AudioOff").visible=!0):(this.owner.getChildByName("btn_AudioOn").visible=!0,this.owner.getChildByName("btn_AudioOff").visible=!1)}}class a extends Laya.Script{constructor(){super(),this.speed=15}Init(t){this.sign=t}onAwake(){Laya.timer.frameLoop(1,this,this.frameLoop)}frameLoop(){this.owner.y+=this.speed}onTriggerExit(t){"BottomCollider"==t.label&&(this.owner.removeSelf(),this.recover())}recover(){Laya.Pool.recover(this.sign,this.owner)}}class n extends Laya.Script{constructor(){super(),this.playerMinX=200,this.playerMaxX=880,this.isStartGame=!1,this.initXArr=[260,450,640,820]}onAwake(){Laya.SoundManager.playMusic("Sounds/FutureWorld_Dark_Loop_03.ogg",0),Laya.stage.on(Laya.Event.MOUSE_DOWN,this,this.mouseDown),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.mouseUp),this.rig=this.owner.getComponent(Laya.RigidBody),Laya.stage.on("StartGame",this,function(){this.isStartGame=!0}),Laya.stage.on("Pause",this,function(){this.isStartGame=!1}),this.Reset()}mouseDown(){if(!this.isStartGame)return;if(Laya.stage.mouseY<=500)return;let t=0;t=Laya.stage.mouseX<Laya.stage.width/2?-1:1,this.rig.linearVelocity={x:6*t,y:0},Laya.Tween.to(this.owner,{rotation:25*t},100)}mouseUp(){this.rig.linearVelocity={x:0,y:0},Laya.Tween.to(this.owner,{rotation:0},100)}onUpdate(){let t=this.owner;t.x<this.playerMinX&&(t.x=this.playerMinX),t.x>this.playerMaxX&&(t.x=this.playerMaxX)}onTriggerEnter(t){"Car"==t.label&&(Laya.SoundManager.playSound("Sounds/CarCrash.ogg",1),this.isStartGame=!1,Laya.stage.event("GameOver")),"Coin"==t.label&&(Laya.SoundManager.playSound("Sounds/Bonus.ogg",1),t.owner.removeSelf(),t.owner.getComponent(a).recover(),Laya.stage.event("AddScore",10))}getRandom(t,e){var a=Math.random()*(e-t);return t+(a=Math.round(a))}Reset(){let t=this.owner;const e=this.getRandom(0,this.initXArr.length-1);t.pos(this.initXArr[e],1360)}}class o extends Laya.Script{constructor(){super(),this.carPrefabArr=[],this.spawnCarArr=[],this.isStartGame=!1}onAwake(){Laya.stage.on("StartGame",this,()=>{this.isStartGame=!0}),Laya.stage.on("GameOver",this,this.gameOver),this.loadCarPrefab()}loadCarPrefab(){const t=["prefab/Car_01.json","prefab/Car_02.json","prefab/Car_03.json","prefab/Car_04.json","prefab/Car_05.json","prefab/Car_05.json","prefab/Coin.json"],e=[];for(let a=0;a<t.length;a++)e.push({url:t[a],type:Laya.Loader.PREFAB});Laya.loader.load(e,Laya.Handler.create(this,function(){for(let e=0;e<t.length;e++)this.carPrefabArr.push(Laya.loader.getRes(t[e]));this.ranTime=this.getRandom(500,1e3),Laya.timer.loop(this.ranTime,this,function(){this.spawn(),this.ranTime=this.getRandom(500,1e3)})}))}spawn(){if(!this.isStartGame)return;const t=[260,450,640,820],e=t[this.getRandom(0,t.length-1)];this.typeIndex=this.getRandom(0,this.carPrefabArr.length-1);const n=Laya.Pool.getItemByCreateFun(this.typeIndex.toString(),function(){return this.carPrefabArr[this.typeIndex].create()},this);Laya.stage.getChildAt(0).getChildAt(0).addChild(n),this.spawnCarArr.push(n),n.pos(e,-300),n.getComponent(a).Init(this.typeIndex.toString())}gameOver(){this.isStartGame=!1;for(let t=0;t<this.spawnCarArr.length;t++){this.spawnCarArr[t].removeSelf()}}getRandom(t,e){let a=Math.random()*(e-t);return t+(a=Math.round(a))}HomeButtonClick(){this.gameOver()}RestartButtonClick(){for(let t=0;t<this.spawnCarArr.length;t++){this.spawnCarArr[t].removeSelf()}}}class i extends Laya.Script{constructor(){super(),this.txt_Best=null,this.txt_Last=null,this.txt_Score=null,this.btn_Pause=null,this.score=0}onAwake(){this.txt_Best=this.owner.getChildByName("txt_best"),this.txt_Last=this.owner.getChildByName("txt_last"),this.txt_Score=this.owner.getChildByName("txt_score"),this.btn_Pause=this.owner.getChildByName("btn_Pause"),this.btn_Pause.on(Laya.Event.CLICK,this,this.pauseBtnClick),Laya.loader.load("font.ttf",Laya.Handler.create(this,this.onFontLoad),null,Laya.Loader.TTF),this.owner.visible=!1,Laya.stage.on("StartGame",this,function(){this.owner.visible=!0,this.Init()}),Laya.timer.loop(300,this,this.AddScore),Laya.stage.on("AddScore",this,this.AddScore),Laya.stage.on("GameOver",this,function(){this.owner.visible=!1})}Init(){this.txt_Last.text="Last:"+Laya.LocalStorage.getItem("LastScore"),this.txt_Best.text="Best:"+Laya.LocalStorage.getItem("BestScore"),this.txt_Score.text="0",this.score=0}onFontLoad(t){console.log(t),this.txt_Best.font=t.fontName,this.txt_Last.font=t.fontName,this.txt_Score.font=t.fontName}AddScore(t=1){0!=this.owner.visible&&(this.score+=t,this.txt_Score.text=this.score.toString())}pauseBtnClick(){Laya.timer.pause(),Laya.stage.event("Pause"),this.owner.visible=!1,Laya.SoundManager.playSound("Sounds/ButtonClick.ogg",1)}}class s extends Laya.Script{constructor(){super()}onAwake(){Laya.loader.load("font.ttf",Laya.Handler.create(this,this.onFontLoad),null,Laya.Loader.TTF),this.owner.getChildByName("btn_Home").on(Laya.Event.CLICK,this,function(){Laya.timer.resume(),this.owner.visible=!1,this.owner.parent.getChildByName("StartPanel").getComponent(e).HomeButtonClick(),this.owner.parent.getComponent(o).HomeButtonClick()}),this.owner.getChildByName("btn_Close").on(Laya.Event.CLICK,this,function(){Laya.timer.resume(),Laya.SoundManager.playSound("Sounds/ButtonClick.ogg",1),this.owner.visible=!1,this.owner.parent.getChildByName("GamePanel").visible=!0}),this.owner.getChildByName("btn_Restart").on(Laya.Event.CLICK,this,function(){Laya.timer.resume(),Laya.SoundManager.playSound("Sounds/ButtonClick.ogg",1),this.owner.visible=!1,this.owner.parent.getComponent(o).RestartButtonClick(),Laya.stage.event("StartGame"),this.owner.parent.getChildByName("player").getComponent(n).Reset()}),this.owner.getChildByName("btn_AudioOn").on(Laya.Event.CLICK,this,function(){this.owner.getChildByName("btn_AudioOn").visible=!1,this.owner.getChildByName("btn_AudioOff").visible=!0,Laya.SoundManager.playSound("Sounds/ButtonClick.ogg",1),Laya.SoundManager.muted=!0,Laya.stage.event("Mute",!0)}),this.owner.getChildByName("btn_AudioOff").on(Laya.Event.CLICK,this,function(){this.owner.getChildByName("btn_AudioOn").visible=!0,this.owner.getChildByName("btn_AudioOff").visible=!1,Laya.SoundManager.playSound("Sounds/ButtonClick.ogg",1),Laya.SoundManager.muted=!1,Laya.stage.event("Mute",!1)}),Laya.stage.on("Pause",this,function(){Laya.SoundManager.playSound("Sounds/ButtonClick.ogg",1),this.owner.visible=!0}),Laya.stage.on("Mute",this,this.IsMute)}IsMute(t){t?(this.owner.getChildByName("btn_AudioOn").visible=!1,this.owner.getChildByName("btn_AudioOff").visible=!0):(this.owner.getChildByName("btn_AudioOn").visible=!0,this.owner.getChildByName("btn_AudioOff").visible=!1)}onFontLoad(t){this.owner.getChildByName("txt_Pause").font=t.fontName}}class r extends Laya.Script{constructor(){super(),this.txt_Score=null,this.txt_HighScore=null}onAwake(){this.txt_Score=this.owner.getChildByName("txt_GameOverScore"),this.txt_HighScore=this.owner.getChildByName("txt_HighScore"),Laya.loader.load("font.ttf",Laya.Handler.create(this,t=>{this.owner.getChildByName("txt_GameOver").font=t.fontName,this.txt_Score.font=t.fontName,this.txt_HighScore.font=t.fontName}),null,Laya.Loader.TTF),this.owner.getChildByName("btn_Home").on(Laya.Event.CLICK,this,function(){Laya.timer.resume(),Laya.SoundManager.playSound("Sounds/ButtonClick.ogg",1);let t=this.owner;t.visible=!1,t.parent.getChildByName("StartPanel").getComponent(e).HomeButtonClick(),t.parent.getComponent(o).HomeButtonClick(),t.parent.getChildByName("player").getComponent(n).Reset()}),this.owner.getChildByName("btn_Reset").on(Laya.Event.CLICK,this,function(){Laya.SoundManager.playSound("Sounds/ButtonClick.ogg",1),Laya.timer.resume(),this.owner.visible=!1,this.owner.parent.getComponent(o).RestartButtonClick(),Laya.stage.event("StartGame"),this.owner.parent.getChildByName("player").getComponent(n).Reset()}),Laya.stage.on("GameOver",this,this.gameOver)}gameOver(){this.owner.visible=!0;const t=this.owner.parent.getChildByName("GamePanel").getComponent(i).score;this.txt_Score.text="Score:"+t;const e=Number(Laya.LocalStorage.getItem("BestScore"));t>e?(Laya.LocalStorage.setItem("BestScore",t),this.txt_HighScore.text="HightScore:"+t):this.txt_HighScore.text="HightScore:"+e,Laya.LocalStorage.setItem("LastScore",t)}}class h{constructor(){}static init(){var h=Laya.ClassUtils.regClass;h("AutoMove.ts",t),h("StartPanel.ts",e),h("Player.ts",n),h("GameManager.ts",o),h("GamePanel.ts",i),h("PausePanel.ts",s),h("GameOverPanel.ts",r),h("Car.ts",a)}}h.width=1080,h.height=1920,h.scaleMode="showall",h.screenMode="none",h.alignV="top",h.alignH="left",h.startScene="Main.scene",h.sceneRoot="",h.debug=!1,h.stat=!1,h.physicsDebug=!1,h.exportSceneToJson=!0,h.init();new class{constructor(){window.Laya3D?Laya3D.init(h.width,h.height):Laya.init(h.width,h.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=h.scaleMode,Laya.stage.screenMode=h.screenMode,Laya.stage.alignV=h.alignV,Laya.stage.alignH=h.alignH,Laya.URL.exportSceneToJson=h.exportSceneToJson,(h.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),h.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),h.stat&&Laya.Stat.show(),Laya.alertGlobalError(!0),Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}onVersionLoaded(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))}onConfigLoaded(){h.startScene&&Laya.Scene.open(h.startScene)}}}();